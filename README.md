# VOICEACTRESS100-RECORDER
音声データの収録を楽にするためのアプリケーションです。
ここから下に使い方を説明していきます。

2つの方法を用意しました。1つは、アプリケーションをダウンロードして自分のPC上で動かす方法です。もう1つは、Web版(https://recorder.ayutaso.com/) にアクセスして使用する方法です。Web版の方が簡単に利用出来ますが、若干動作が重いので、気になる場合は自身のローカルで試してみてください。基本Web版で良いと思います。

# 使い方
学習データ100 + 評価データ10の計110発話を録音して頂きたいです。
110発話一気に録音しなくても大丈夫です。途中で途切れても、その時点までのデータは保存されます。同じ名前でログインすることで、続きから始められます。

### 収録環境
- なるべく静かな環境で録音してください。
- PCで録音することを想定していますが、おそらくスマホやタブレットからでも録音可能です。(トリミングの操作が難しいかもしれませんが)
- 普段の話し声で録音してください。

### 音声の収録方法
1. https://recorder.ayutaso.com/ にアクセスします。
2. 名前を入力して「ログイン」を押します。この時の名前は他の人と被らなければ何でも良いです。
3. 「Record」ボタンを押すと録音が始まります。画面に表示されている文字列を読み上げて下さい。
   1. 「Record」ボタンを押すと同時に発声を始めると、声にクリック音が入ってしまうので、少し開けてから発声を始めて下さい。
4. 「Stop」ボタンを押すと、録音が完了します。
5. 前後の不要な部分をトリミングする。
   1. クリック音と無音区間を厳密でなくてよいので画面の波形を見て、✂マークから適当にトリミングしておいてほしいです。UIで区間を選択して「Trim」を押すと、その部分が削除されます。
   2. 選択した後に「trim」を押さないとトリミングされないので注意してください。
6. 問題無ければ「録音を保存して次へ」を押して次の録音に進んでください。
   1. 撮り直す場合は🔄️を押すことで再度録音が出来ます。トリミングのやり直し等も出来ます。困ったときはブラウザをリロードすればやり直し出来ます。
   2. 一度「保存して次へ」を押すと、データは保存され、消えることはありません。
   3. 一度保存したデータを撮り直す場合は、「録音済み音声一覧」のドロップダウンから撮り直したいデータを選択し、「選択した音声を再録音する」を押してください。
      1. 再録音した後に「保存して次へ」を押すと、元のデータは上書きされます。この時、次に表示されるテキストは再録音した発話の１つ次になります。最新のデータの録音に戻りたい場合は、再録音し保存した後に「最新の発話に戻る」を押してください。
7. 110発話まで完了したらサーバー上のデータを確認するのでSlackでメンションをください。
   1. データとしては400発話まで録音可能なように用意されていますが、110発話で十分です。それ以上はやりたい人はやっても良いよという感じです。


### スペクトログラムの表示機能
録音した音声のスペクトログラムを表示することが出来ます。録音した音声の下にある「スペクトログラムを表示」を押すと、スペクトログラムが表示されます。これにより、問題なく音声が録音されているかを確認することが出来ます。このとき、22kHzまでスペクトログラムが表示されているか確認して貰えると助かります。

スペクトログラムの表示は処理が重いので、「スペクトログラムを非表示にする」を押して非表示にすることもできます。

### その他
- 操作方法等でわからないことがあれば、Slackでメンションをください。
- エラーが出て進めなくなった場合はブラウザをリロードすれば解消されると思います。
- 何か質問あれば気軽にSlackでメンション等してください。スクリーンショットを添えてもらえると助かります。
- 録音したデータはayutoが管理しているサーバー上に保存されます。


# 発展:アプリケーションをダウンロードして自分のPC上で動かす方法

**注意**：Google Cloabは使わないでください。録音したデータが消えます。

## 必要な物
以下の2つが必要になるので、事前にインストールしておいてください。
- [git](https://git-scm.com/)
  - コードをダウンロードするために必要です。便利なのでこれを期に使えるようになるといいです。
  - インストール方法
    - Windowsに入れる場合：[Gitのインストール方法(Windows版)](https://qiita.com/T-H9703EnAc/items/4fbe6593d42f9a844b1c)
    - WLSに入れる場合：`sudo apt-get install git`
  - gitの基本的な使い方：[初心者のためのやさしいGit](https://zenn.dev/getgotgoto/articles/506bcfbcd55149)
- Python3.9以上の環境
  - Pythonのバージョンを確認するには`python -V`を実行してください。
  - [Python3.8は2024年10月にサポートが終了している](https://devguide.python.org/versions/)ので、良い機会と思ってPython3.9以上にアップデートするのが良いでしょう。


## インストール
まずはこのリポジトリをPC内のお好きな場所にクローンします。

このコマンドを実行すると、コマンドを実行した場所に新しく`jsut-recorder`というディレクトリが作成され、その中にこのリポジトリのファイルがダウンロードされます。
```bash
git clone https://github.com/hikuohiku/jsut-recorder.git
```
ここから先のコマンドはクローンしたディレクトリに移動してから実行してください。

次に、必要なライブラリをインストールします。

まず、Pythonの仮想環境を作成します。仮想環境を作成することで、PC内のPythonのバージョンやライブラリのバージョンを気にすることなく、アプリケーションを実行することができます。
```bash
python -m venv .venv
```
次に、作成した仮想環境の中に入ります。[^1]
```bash
source .venv/Scripts/activate
```

[^1]: 仮想環境から抜ける場合は `deactivate` を実行してください。

仮想環境の中に入ったら、以下のコマンドで必要なライブラリをインストールします。これにより、仮想環境の中にライブラリがインストールされます。
```bash
pip install -r requirements.txt
```

## 起動
以下のコマンドでアプリケーションを起動します。仮想環境の中で実行しないとライブラリが無いためエラーが発生します。
```bash
python app.py
```
起動が完了すると、ターミナルに`Running on local URL:  http://127.0.0.1:7860`と表示されるので、http://127.0.0.1:7860 にアクセスしてください。ブラウザ上でアプリケーションが起動しています。


# dev docs

## アプリケーション起動

```bash
uv run app.py
```


## るび付きcsv生成
```bash
uv run ruby.py
```
